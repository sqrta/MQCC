qreg q[10];
creg r[1];
fcho c1,c2,c3,c4 = {0, 1};

h(q[0]);
measure(q[0],r[0]);

module barrierOrNot(c,q1,q2){
    choice (c){
        0:  barrier(q1,q2);
        1:  pass
    }
}

module hamil(q0,q1,q2,q3,c){
    cx(q3,q2);
    barrierOrNot(c,q1,q2);
    cx(q1,q0);
    cx(q2,q0);
}

module hamil2(q0,q1,q2,q3){
    cx(q3,q2);
    cx(q1,q2);
    cx(q1,q0);
    cx(q2,q0);
}


choice (c1){
    0:  hamil(q[0], q[1], q[2], q[3], c3);

    1:  hamil(q[6], q[7], q[8], q[9], c3);
}

choice (c2){
    0:  hamil(q[0], q[1], q[2], q[3], c4);

    1:  hamil2(q[6], q[7], q[8], q[9]);
}